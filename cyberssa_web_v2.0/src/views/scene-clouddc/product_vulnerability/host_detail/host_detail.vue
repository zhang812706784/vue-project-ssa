<template>
  <div class="host">
    <section class="host-detail">
      <div class="header">
        <div>
          <div class="tool-bar">
            <Icon type="ios-help" color="skyblue" size="24" style="margin-right:8px"></Icon>
            <Icon type="android-add-circle" color="green" size="24" style="margin-right:8px"></Icon>
            <Icon @click.native="goHostList()" type="ios-list" color="green" size="24" style="margin-right:8px"></Icon>
            <Icon type="ios-trash" color="red" size="24" style="margin-right:8px"></Icon>
            <Icon type="android-settings" color="blue" size="24" style="margin-right:8px"></Icon>
            <Icon type="ios-download" color="#11CD6E" size="24" style="margin-right:8px"></Icon>
          </div>
          <h1>
            <Icon type="clipboard" color="skyblue" style="margin-right:8px"></Icon>Host: {{testData.host}}</h1>
        </div>
        <div class="dec">
          <p>ID: {{testData.uuid}}</p>
          <p>Created: {{testData.createTime | timeFormat}}</p>
          <p>Modified: {{testData.uuid}}</p>
          <p>Owner: {{testData.admin}}</p>
        </div>
      </div>
      <div class="content">
        <table>
          <tr v-for="(value,key) in testData">
            <td>{{key}}:</td>
            <td v-if="typeof value !== 'object'">{{value.toString()}}</td>
            <td v-else>
              <span v-for="item in value">{{item}}► </span>
            </td>
          </tr>
        </table>
      </div>
    </section>
    <section class="last-Identifiers">
      <div class="header">
        <div class="title">
          <h1>Latest Identifies</h1>
        </div>
        <div class="action">
          <Icon type="android-expand" color="red" size="24" style="margin-right:8px"></Icon>
        </div>
      </div>
      <div class="content">
        <tp-table :all_params="lastIdentifiersTableData"></tp-table>
      </div>
    </section>
    <section class="user-tags">
      <div class="header">
        <div class="title">
          <h1>
            <Icon type="clipboard" color="skyblue" style="margin-right:8px"></Icon>User Tags ( {{testData.userTags}} )</h1>
        </div>
        <div class="action">
          <Icon type="android-add-circle" color="#11CD6E" size="24" style="margin-right:8px"></Icon>
          <Icon type="ios-help" color="skyblue" size="24" style="margin-right:8px"></Icon>
          <!-- <Icon type="android-contract" color="skyblue" size="24" style="margin-right:8px"></Icon> -->
          <Icon type="android-expand" color="red" size="24" style="margin-right:8px"></Icon>
        </div>
      </div>
      <div class="content">

      </div>
    </section>
    <section class="permissions">
      <div class="header">
        <div class="title">
          <h1>
            <Icon type="clipboard" color="skyblue" style="margin-right:8px"></Icon>permissions ( {{testData.permissions}} )</h1>
        </div>
        <div class="action">
          <Icon type="android-add-circle" color="#11CD6E" size="24" style="margin-right:8px"></Icon>
          <Icon type="ios-help" color="skyblue" size="24" style="margin-right:8px"></Icon>
          <!-- <Icon type="android-contract" color="skyblue" size="24" style="margin-right:8px"></Icon> -->
          <Icon type="android-expand" color="red" size="24" style="margin-right:8px"></Icon>
        </div>
      </div>
      <div class="content">

      </div>
    </section>
  </div>
</template>

<script>
import TpTable from '@/components/locale-components/tp-table/tp-table';
import TpSsaEcharts from '@/components/locale-components/tp-ssa-echarts/tp-ssa-echarts';
import moment from 'moment';
import mixin from '../mixin/mixin';
export default {
  name: 'target_detail',
  mixins: [mixin],
  components: { TpSsaEcharts, TpTable },
  data() {
    return {
      testLastIdentifiersData: {
        value: [
          'cpe:/o:hp:integrated_lights-out',
          'cpe:/o:centos:centos:6',
          'cpe:/o:hp:integrated_lights-out_4_firmware:2.50'
        ],
        report: [
          '325ddc65-9ec5-4e7d-ab1b-bb8959eb9ca4',
          '325ddc65-9ec5-4e7d-ab1b-bb8959eb9ca4',
          '325ddc65-9ec5-4e7d-ab1b-bb8959eb9ca4'
        ],
        NVT: ['1.3.6.1.4.1.25623.1.0.111067', '1.3.6.1.4.1.25623.1.0.20285']
      },
      testData: {
        host: '1.196.127.50',
        comments: '',
        ip: '1.196.127.50',
        os:
          'HP Integrated Lights-Out (cpe:/o:hp:integrated_lights-out_4_firmware:2.50)',
        route: [
          '172.20.20.28',
          '192.168.100.5',
          '192.168.100.2',
          '10.255.88.177',
          '10.255.36.109',
          '124.205.98.201',
          '124.205.98.221',
          '218.241.244.5',
          '218.241.244.69',
          '1.202.252.41',
          '106.120.235.25',
          '219.141.135.170',
          ' 202.97.63.86',
          '219.150.193.18',
          '1.196.127.50'
        ],
        serverity: '10.0',
        userTags: 'none',
        permissions: 'none',
        uuid: 'c3f1674df52e446eb025ce8469c4c443',
        createTime: '2018-08-22 04:18:27',
        admin: 'zmj'
      },
      lastIdentifiersTableData: {}
    };
  },
  created() {
    this.lastIdentifiersTableData = {
      id: 'last_identifiers_table',
      index: false,
      loading: false,
      ajaxType: 'get',
      index: false,
      loading: false,
      checkBox: false,
      url: '/api/ssa_table',
      data: {
        index: 'asset',
        type: 'vm'
      },
      cols: [
        {
          title: this.$t('Name'),
         
        },
        {
          title: this.$t('Values'),
           render: (h,params) =>{
            return this.createALink(
              h,
              this.testLastIdentifiersData.value[parseInt(Math.random() * this.testLastIdentifiersData.value.length)],
              'operate_system',
              params.row
            );
          }
        },
        {
          title: this.$t('Created')
        },
        {
          title: this.$t('Source'),
          render: (h,params) =>{
            return h('span',['Report: ',this.createALink(
              h,
              this.testLastIdentifiersData.report[parseInt(Math.random() * this.testLastIdentifiersData.report.length)],
              'report',
              params.row
            ),' NVT( ',this.createALink(
              h,
              this.testLastIdentifiersData.NVT[parseInt(Math.random() * this.testLastIdentifiersData.NVT.length)],
              'nvt',
              params.row
            ),' )']);
          }
        },
        {
          title: this.$t('Actions')
        }
      ]
    };
  },
  filters: {
    timeFormat: function(value) {
      return moment(value).format('YYYY-MM-DD hh:mm:ss');
    }
  },
  beforeRouteEnter(to, from, next) {
    next(vm => {
      vm.getHostDetail();
    });
  },
  methods: {
    getHostDetail() {},
    goHostList() {
      this.$router.push('host');
    }
  }
};
</script>

<style scoped>
@import '../common_css/common_css.css';
.host {
  /** 最外层div css 设置有问题 需要在底部补上高度**/
  color: white;
  padding: 0 8px 108px;
  box-sizing: border-box;
}
</style>
