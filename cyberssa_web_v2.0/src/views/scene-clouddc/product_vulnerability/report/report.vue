<template>
  <div class="report">
    <section class="header">
      <div>
        <div class="tool-bar">
          <Icon type="ios-help" color="skyblue" size="24" style="margin-right:8px"></Icon>
          <Icon type="ios-upload" color="green" size="24" style="margin-right:8px"></Icon>
        </div>
        <h1>
          <Icon type="clipboard" color="skyblue" style="margin-right:8px"></Icon>Reports(3 of 39)</h1>
      </div>
      <div>
        <Icon type="clipboard" color="skyblue" size="24" style="margin-right:8px"></Icon>
      </div>
    </section>
    <section class="content">
      <div class="chart">
        <div class="chart-item">
          <div class="chart-item-title">
            <Dropdown class="chart-item-title-menu" placement="bottom-start">
              <a href="javascript:void(0)">
                <Icon type="ios-arrow-down"></Icon>
              </a>
              <DropdownMenu slot="list">
                <DropdownItem>Show datached chart window</DropdownItem>
                <DropdownItem>Download CSV</DropdownItem>
                <DropdownItem>Show HTML table</DropdownItem>
                <DropdownItem>Show copyable SVG</DropdownItem>
                <DropdownItem>Download SVG</DropdownItem>
              </DropdownMenu>
            </Dropdown>Tasks with most High results per host</div>
        </div>
        <div class="chart-item">
          <div class="chart-item-title">
            <Dropdown class="chart-item-title-menu" placement="bottom-start">
              <a href="javascript:void(0)">
                <Icon type="ios-arrow-down"></Icon>
              </a>
              <DropdownMenu slot="list">
                <DropdownItem>Show datached chart window</DropdownItem>
                <DropdownItem>Download CSV</DropdownItem>
                <DropdownItem>Show HTML table</DropdownItem>
                <DropdownItem>Show copyable SVG</DropdownItem>
                <DropdownItem>Download SVG</DropdownItem>
              </DropdownMenu>
            </Dropdown>Tasks with most High results per host</div>
        </div>
        <div class="chart-item">
          <div class="chart-item-title">
            <Dropdown class="chart-item-title-menu" placement="bottom-start">
              <a href="javascript:void(0)">
                <Icon type="ios-arrow-down"></Icon>
              </a>
              <DropdownMenu slot="list">
                <DropdownItem>Show datached chart window</DropdownItem>
                <DropdownItem>Download CSV</DropdownItem>
                <DropdownItem>Show HTML table</DropdownItem>
                <DropdownItem>Show copyable SVG</DropdownItem>
                <DropdownItem>Download SVG</DropdownItem>
              </DropdownMenu>
            </Dropdown>Tasks with most High results per host</div>
        </div>
      </div>
      <div class="table">
        <tp-table ref="reportTable" :all_params="reportTableParams"></tp-table>
      </div>
    </section>
  </div>
</template>

<script>
import TpTable from '@/components/locale-components/tp-table/tp-table';
import TpSsaEcharts from '@/components/locale-components/tp-ssa-echarts/tp-ssa-echarts';
import mixin from '../mixin/mixin';
import moment from 'moment';
export default {
  name: 'report',
  mixins: [mixin],
  components: { TpSsaEcharts, TpTable },
  data() {
    return {
      testData: [
        'Fri Aug 24 16:37:33 2018',
        'Tue Jul 17 09:32:52 2018',
        'Tue Jul 17 09:26:31 2018'
      ],
      // 注意 当前table在 2.x 版本的框架中无法使用分组的表头 建议升级到 3.x
      reportTableParams: {}
    };
  },
  created() {
    this.reportTableParams = {
      id: 'report_table',
      ajaxType: 'get',
      index: false,
      loading: false,
      checkBox: false,
      url: '/api/ssa_table',
      data: {
        index: 'asset',
        type: 'vm'
      },
      add_btn: false,
      del_btn: false,
      modify_btn: false,
      cols: [
        {
          title: this.$t('Date'),
          render: (h, params) => {
            return this.createALink(
              h,
              this.testData[parseInt(Math.random() * this.testData.length)],
              'report_detail',
              params.row
            );
          }
        },
        {
          title: this.$t('Status'),
          render: (h, params) => {
            return this.createProgress(h, 'done', 80);
          }
        },
        {
          title: this.$t('Task'),
          render: (h, params) => {
            return this.createALink(
              h,
              '1.194.144.230',
              'task_detail',
              params.row
            );
          }
        },
        {
          title: this.$t('Serverity'),
          render: (h, params) => {
            return this.createProgress(h, 'done', 80);
          }
        },
        {
          title: this.$t('High')
        },
        {
          title: this.$t('Medium')
        },
        {
          title: this.$t('Low')
        },
        {
          title: this.$t('Log')
        },
        {
          title: this.$t('False Pos')
        },
        {
          title: this.$t('Actions')
        }
      ]
    };
  },
  filters: {
    timeFormat: function(value) {
      return moment(value).format('YYYY-MM-DD hh:mm:ss');
    }
  },
  beforeRouteEnter(to, from, next) {
    next(vm => {
      vm.getReportList();
    });
  },
  methods: {
    getReportList() {
      // 获取报告列表
    }
  }
};
</script>

<style scoped>
@import '../common_css/common_css.css';
.report {
  /** 最外层div css 设置有问题 需要在底部补上高度**/
  color: white;
  padding: 0 8px 108px;
  box-sizing: border-box;
}

.ivu-progress-show-info .ivu-progress-outer {
  margin: 0;
  padding: 0;
}
</style>
